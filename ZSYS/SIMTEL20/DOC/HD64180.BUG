 
                     Last update:  02/09/86
                           HD64180.BUG
                              V 1.0
 
 
I believe the following section was written by:
 
                             WA7GXD
 
           (See Gateway Vol 2, No 11.  Jan. 24, 1986)
 
 
     Iæ  yoõ  arå planninç oî usinç á Hitaché HD6418° (guesó  yoõ 
havå tï uså Hitaché iæ yoõ plaî oî usinç á 64180...© pleaså  notå 
thaô iô ió noô directlù compatiblå witè Z8° (tm© stylå peripheraì 
ICó wheî usinç thå Modå ² interrupô scheme®   É know» É founä ouô 
thå hard¬ expensivå way.
 
     É  havå  designeä á packeô switcè foò Amateuò  packeô  radiï 
usagå thaô ió baseä oî thå 64180¬ á PIO¬ á paiò oæ SIO/2ó anä thå 
NCR538° SCSÉ chip®  Iô alsï haó 1¶ bytewidå socketó anä screwó oî 
thå  sidå oæ á 5.25¢ floppù disë controller®   Iô ió oî á 4-layeò 
boarä  anä wå haä prototypå boardó madå (compileä ió thå  nearesô 
softwarå  equivalent...)®   Durinç finaì hardwarå debuç  testing¬ 
modå ² interruptó werå switcheä on.
 
     Thå peripheraì woulä servicå exactlù ± interrupt¬  theî locë 
itó IEÏ linå lo÷ anä staù thaô waù untiì poweò off/poweò oî reseô 
waó accomplished!
 
     Iô  turnó  ouô thaô thå timinç oæ thå LIRª outpuô  froí  thå 
6418°  needó tï bå delayeä (undocumenteä requiremenô oæ  thå  Z8° 
(tm©  peripherals!)®  Hitaché haó á simplå circuiô tï  accomplisè 
thió  iæ  yoõ  happeî  tï havå thå sparå fliğ floğ  anä  OÒ  gatå 
floatinç  arounä oî youò board®   É didn'ô anä simplù  redesigneä 
thå wait-statå generatoò tï accomplisè thå samå thing.
 
     No÷ Modå ² workó jusô fine.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
  Š 
  
                  The following section is by:
 
                             KA8BMT
 
                           Reference:
  
Hitaché  HD6418° 8-Biô Higè Integratioî CMOÓ Microprocessoò  Datá 
Booë  [January¬ 198µ #U77]
 
                  PG 27: I/O ADDRESSING NOTES:
 
     "Thå  on-chiğ I/Ï registeò addresseó arå locateä iî thå  I/Ï 
addresó  spacå froí 0000È tï 00FFÈ (16-biô I/Ï  addresses).¢   [Á 
notå  undeò figurå 2.2.µ oî pagå 15º  'NOTEº  A16-A1¸ ½ ° foò I/Ï 
cycles'.İ "Thus¬  tï accesó thå on-chiğ I/Ï registeró (usinç  I/Ï 
instructions),"
 
 
     [Ió therå somå otheò waù tï accesó theså registers¬  besideó 
I/Ï instructions¿  IOEª anä MEª woulä determinå whetheò iô ió I/Ï 
oò  MEmory¬  sï whaô doeó thå lasô parô oæ thå previouó paragrapè 
mean?]
 
"thå high-ordeò ¸ bitó oæ thå 16-biô I/Ï addresó musô bå 0."
 
     "Thå  conventionaì I/Ï instructionó (OUÔ (m),Á ¯ IÎ A,(m©  ¯ 
OUTÉ ¯ INÉ ¯ etc.© Placå thå contentó oæ á CPÕ register,"
 
     [Thå "B¢ register¬  thió ió becauså oæ thå waù thå Z-8° (tm© 
handleó  thå "IÎ g,(C)¢ anä thå "OUÔ (C),g¢  instructions®   Thió 
meanó  thaô yoõ coulä desigî á Z-8° circuiô thaô coulä havå  morå 
thaî  25¶ I/Ï address¬  bù usinç thå "B¢ registeò aó parô oæ  thå 
I/Ï  address®  Thió  coulä  alsï meanó thaô iæ youò  I/Ï  addresó 
decodeò doeó noô properlù accounô foò thå A¸ - A1µ addresó  lineó 
yoõ maù noô geô thå I/Ï addresó yoõ want.]
 
"oî  thå  high-ordeò ¸ bitó oæ thå addresó bus¬  anä thuó maù  bå 
difficulô tï uså foò accessinç oî chiğ I/Ï registers."
 
     "Foò efficienô on-chiğ I/Ï registeró access¬ á numbeò oæ ne÷ 
instructionó havå beeî addeä whicè forcå thå high-ordeò ¸ bitó oæ 
thå 16-biô I/Ï addresó tï 0®   Theså instructionó arå IN0¬  OUT0¬ 
OTIM¬  OTIMR¬ OTDM¬ OTDMÒ anä TSTIÏ (Seå sectioî 3.± Instructionó 
set)."
 
     [Unfortunitlù   thå  instructionó  describeä  iî  thå   lasô 
paragrapè  woulä  noô  bå Z-8° compatible¬  iæ  thaô  ió  oæ  anù 
consideration®   Á  possiblå  solutioî woulä bå tï zerï  thå  "B¢ 
registeò   oæ  thå  6418°  oò  thå  Z-8°  beforå  doinç  anù  I/Ï 
instructions¬  howeveò  thió  maù  noô bå possiblå  {iæ  thå  "B¢ 
registeò ió beinç usedı oò practicaì iî alì cases.]
  Š
     "Notå  thaô wheî writinç tï aî internaì  I/Ï  register¬  thå 
samå  I/Ï  writå  occuró  oî  thå  externaì  bus®   However¬  thå 
duplicatå  externaì  I/Ï  writå cyclå wilì exhibiô  internaì  I/Ï 
writå  cyclå  timing®   Foò  example¬  thå WAITª  inpuô  anä  thå 
programmablå  waiô  statå generatoò arå  ignored.¢   [Thió  coulä 
conceivablù  causå  somå slo÷ peripheraló tï 'gï ouô tï  lunch'.İ 
"Similarly¬  internaì  I/Ï  reaä cycleó alsï  causå  á  duplicatå 
externaì  I/Ï  reaä cyclå - however¬  thå externaì reaä  datá  ió 
ignoreä bù thå HD64180."
 
     "Normally¬  externaì I/Ï addresseó shoulä bå choseî tï avoiä 
overlağ  witè  internaì  I/Ï  addresseó tï  avoiä  duplicatå  I/Ï 
accesses."
 
     Severaì placeó Hitaché stateó thaô thå HD6418° caî  directlù 
addresó  64Ë oæ I/Ï addresó [whicè iô caî iî hardwardİ (pageó  2¬ 
5¬  15¬  5± anä others)¬ howeveò iô doeó noô telì ho÷ tï dï iô iî 
software®   Ió therå somå waù besideó doinç trickó witè "B"¬  DMÁ 
oò  I/Ï blocë instructions¬  thaô É missed¬  tï addresó morå thaî 
25¶   I/Ï  locations¿     (Sucè  aó  "OUÔ  (1234H),reg¢  oò   "IÎ 
reg,(1234H)".)
 
 
