
CHGDISK.FIX

The program Chgdisk.com (in Chgdisk11.lbr) comes as manna from heaven
to those with the Advent Ramdisk and TurboRom, in that it makes it
possible to reconfigure the ramdisk, including the block sizes. For
example, a 1 meg ramdisk has 4K blocks by default, and with a lot
of little files that uses up space fast. With Chgdisk it is possible
to redefine these as 2K blocks and open up a lot of space. (In my
case an extra 100K was made available.) This is obviously good.

However--there's a rub. When the reset button is hit, which inevitably
is pretty often, the directory of the reconfigured ramdisk vanishes.
This would appear to make Chgdisk pretty useless. One of the primary
advantages of the Advent Ramdisk is that the files on it survive a
reset (unless reconfigured as the A drive by Turbomap). The prospect
of losing all working files as well as all programs every time the
system hangs is not a pleasant one. So at this point it seemed that
Chgdisk came close, but no cigar.

A series of messages on the Kaypro Sig of CompuServe finally produced
the solution, which came from Derek McKay of Advent Products in a
cryptic message. When interpreted by Ted Silveira the secret of
how to save the imperiled directory works like this: After the
reset, do NOT log into the ramdisk (probably drive C) until
Chgdisk.com has been run again WITH THE SAME PERIMETERS as used
to reconfigure it in the first place. (Otherwise disaster.)
This restores the directory and thus makes all the files
accessible.

The best approach here is to use the program Synonym.com (or Syn.com)
to create a command file that will run the proper command line for
Chgdisk.com. (Chgdisk.com must remain on the same drive and user
area as the created command file.) On my Kaypro I have set up a
default of 2K blocks and 128 directory entries. (The number of
directory entries is related to the block size. 1k blocks
produce 64 directory entries; 2k blocks produce 128 directory
entries; 4k blocks produce 256 directory entries.) Note that
large files (such as spelling checker dictionaries) can take
2 or more directory entries, and in practice the 128 directory
entries available with 2k blocks turns out to be more like 100
on my ramdisk. (Of course you cannot save a file once you have
used up all directory entries. Therefore find a version of D.com
that shows available directories to be aware of how many remain.)

This, then, is the default command line I have been using to
reconfigure my ramdisk from 4K blocks and 256 directory entries
to 2k blocks and 128 directory entries:

	CHGDISK BSH=4 DRM=127 OFF=1 Y

In order to avoid a situation where I would reset and forget
to run Chgdisk.com, I created a com file with Syn.com called
Menu.com, which I keep on the disk in drive A. Since my Kaypro 1
looks first for a program of that name to auto-load, this means
that Chgdisk, with the proper command line, is run every time
I reset and everything on the ramdisk is safely preserved.

The Advent Ramdisk was excellent in the first place, not
interfering at all with the running of any programs and
functioning in a completely natural way as drive C (or
whatever you designate it to be). Chgdisk.com makes a good
ramdisk even better, especially when used with the proper
precautions, as outlined here.

Chgdisk.lbr has been released into the public domain by
Advent Products.


Bruce Diamond
70007,2267
